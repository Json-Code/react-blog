{"version":3,"sources":["pages/admin/article/item.js"],"names":["Option","createArticle","props","_this","Object","D_Codeing_blog_admin_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_11__","this","D_Codeing_blog_admin_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_13__","D_Codeing_blog_admin_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_14__","call","handleSubmit","e","preventDefault","form","validateFields","_ref","D_Codeing_blog_admin_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_10__","D_Codeing_blog_admin_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_6___default","a","mark","_callee","err","values","content","params","_ref2","_ref3","wrap","_context","prev","next","state","markdown","console","log","tag","D_Codeing_blog_admin_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_9__","category","String","id","api","post","sent","code","antd_es_message__WEBPACK_IMPORTED_MODULE_8__","success","history","push","stop","_x","_x2","apply","arguments","author","title","updateMarkdown","bind","D_Codeing_blog_admin_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_15__","editor","data","value","setState","match","getTagList","getDetail","get","summary","setFieldsValue","val","editorState","getFieldDecorator","categoryOption","map","react__WEBPACK_IMPORTED_MODULE_19___default","createElement","name","key","tagOption","txt","className","antd_es_form__WEBPACK_IMPORTED_MODULE_3__","assign","onSubmit","labelCol","xs","span","sm","xxl","wrapperCol","md","Item","label","rules","required","message","antd_es_input__WEBPACK_IMPORTED_MODULE_5__","placeholder","antd_es_select__WEBPACK_IMPORTED_MODULE_18__","mode","style","width","addonBefore","onChange","handlChangeeCategory","handleChangeTag","_uiw_react_markdown_editor__WEBPACK_IMPORTED_MODULE_20__","antd_es_button__WEBPACK_IMPORTED_MODULE_1__","type","htmlType","React","Component","ArticleItem","create"],"mappings":"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","file":"static/js/19.7b44cdb8.chunk.js","sourcesContent":["import { Form, Input, Button, Select, message } from 'antd'\r\nimport React from 'react'\r\nimport MarkdownEditor from '@uiw/react-markdown-editor';\r\nimport './item.less'\r\nimport api from '../../../api'\r\n\r\nconst { Option } = Select\r\n\r\nclass createArticle extends React.Component {\r\n  constructor(props) {\r\n    super(props)\r\n    this.state = {\r\n      id: '',\r\n      tag: [],\r\n      category: [],\r\n      form: {\r\n        author: '',\r\n        title: '',\r\n      },\r\n      markdown: ''\r\n    }\r\n    this.updateMarkdown = this.updateMarkdown.bind(this);\r\n  }\r\n  updateMarkdown(editor, data, value) {\r\n    this.setState({ markdown: value });\r\n  }\r\n  componentDidMount () {\r\n    const id = this.props.match.params.id\r\n    this.setState({id})\r\n    this.getTagList()\r\n    id && this.getDetail(id)\r\n  }\r\n  async getDetail (id) {\r\n    const {code, data} = await api.get('/article/item', {id})\r\n    if (code !== 1000) return false\r\n    const { title, author, summary, category, tag, content } = data\r\n    this.props.form.setFieldsValue({title, author, summary, category, tag})\r\n    this.setState({\r\n      markdown: content\r\n    })\r\n  }\r\n\r\n  async getTagList () {\r\n   const {data, code} = await api.get('tag/list/all')\r\n   if (code === 1000) this.setState({tag: data})\r\n   const category = await api.get('category/list/all')\r\n   if (category.code === 1000) this.setState({category: category.data})\r\n  }\r\n\r\n  handleSubmit = (e) => {\r\n    e.preventDefault()\r\n    this.props.form.validateFields(async (err, values) => {\r\n      if (!err) {\r\n        const content = this.state.markdown\r\n        console.log(values.tag)\r\n        let params = {\r\n          ...values,\r\n          category: String(values.category),\r\n          tag: String(values.tag),\r\n          content\r\n        }\r\n        if (this.state.id) {\r\n          console.log(1111)\r\n          params.id = this.state.id\r\n          const {code} = await api.post('/article/update', params)\r\n          if (code === 1000) {\r\n            message.success('修改成功')\r\n            this.props.history.push('/admin/article')\r\n          }\r\n        } else {\r\n          console.log(222)\r\n          const {code} = await api.post('/article/create', params)\r\n          if (code === 1000) {\r\n            message.success('新增成功')\r\n            this.props.history.push('/admin/article')\r\n          }\r\n        }\r\n      } \r\n    })\r\n  }\r\n  handleChangeTag (val) {\r\n    console.log(val)\r\n  }\r\n  handlChangeeCategory (val) {\r\n    console.log(val)\r\n  }\r\n  onEditorStateChange (editorState) {\r\n    this.setState({\r\n      editorState\r\n    })\r\n  }\r\n  render() {\r\n    const formItemLayout = {\r\n      labelCol: {\r\n        xs: { span: 8 },\r\n        sm: { span: 5 },\r\n        xxl: { span: 2 },\r\n      },\r\n      wrapperCol: {\r\n        xs: { span: 24 },\r\n        sm: { span: 16 },\r\n        md: { span: 12 }\r\n      }\r\n    }\r\n    const { getFieldDecorator } = this.props.form\r\n    let categoryOption = this.state.category.map(category => {\r\n      return <Option value={category.name} key={category.name}>{category.name}</Option>\r\n    })\r\n    let tagOption = this.state.tag.map(tag => {\r\n      return <Option value={tag.name} key={tag.name}>{tag.name}</Option>\r\n    })\r\n    const txt = this.state.id ? 'update' : 'create'\r\n    \r\n    return (\r\n      <div className='admin-article'>\r\n        <Form onSubmit={this.handleSubmit} {...formItemLayout}>\r\n          <Form.Item label='标题'>\r\n            {getFieldDecorator('title', {\r\n              rules: [{ required: true, message: '请输入标题' }],\r\n            })(\r\n              <Input placeholder=\"请输入标题\" />\r\n            )}\r\n          </Form.Item>\r\n          <Form.Item label='作者'>\r\n            {getFieldDecorator('author', {\r\n              rules: [{ required: true, message: '请输入作者' }],\r\n            })(\r\n              <Input placeholder=\"请输入作者\" />\r\n            )}\r\n          </Form.Item>\r\n          <Form.Item label='摘要'>\r\n            {getFieldDecorator('summary', {\r\n              rules: [{ required: true, message: '请输入描述' }],\r\n            })(\r\n              <Input placeholder=\"请输入描述\" />\r\n            )}\r\n          </Form.Item>\r\n          <Form.Item label='分类'>\r\n            {getFieldDecorator('category', {\r\n              rules: [{ required: true, message: '请选择分类' }],\r\n            })(\r\n            <Select\r\n            mode=\"multiple\"\r\n            style={{ width: '100%' }}\r\n            placeholder=\"请选择标签\"\r\n            addonBefore='标签'\r\n            onChange={this.handlChangeeCategory.bind(this)}>\r\n            { categoryOption }\r\n          </Select>\r\n            )}\r\n          </Form.Item>\r\n          <Form.Item label='标签'>\r\n            {getFieldDecorator('tag', {\r\n              rules: [{ required: true, message: '请选择标签' }],\r\n            })(\r\n            <Select\r\n            mode=\"multiple\"\r\n            style={{ width: '100%' }}\r\n            placeholder=\"请选择标签\"\r\n            addonBefore='标签'\r\n            onChange={this.handleChangeTag.bind(this)}>\r\n            { tagOption }\r\n          </Select>\r\n            )}\r\n          </Form.Item>\r\n          <Form.Item label='内容' wrapperCol={{span: 19}}>\r\n            <MarkdownEditor\r\n              value={this.state.markdown}\r\n              onChange={this.updateMarkdown}\r\n            />\r\n          </Form.Item>\r\n          <Form.Item wrapperCol={{span: 24}}>\r\n            <div className=\"article-button\">\r\n              <Button type=\"primary\" htmlType=\"submit\">\r\n              { txt }\r\n              </Button>\r\n            </div>\r\n          </Form.Item>\r\n        </Form>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nconst ArticleItem = Form.create({ name: 'normal_login' })(createArticle);\r\n\r\nexport default ArticleItem\r\n"],"sourceRoot":""}